<%= render 'shared/theme_toggle' %>
<%# search form moved below the fixed A–Z bar spacer %>

<%# Install banner - uses Stimulus controller for PWA installation %>
<%= render 'shared/install_banner' %>

<%# Page header with church/account name (scrolls away) %>
<div class="max-w-screen-lg mx-auto px-4 mb-2">
  <% account_name = ActsAsTenant.current_tenant&.name || 'Tu Iglesia' %>
  <div>
    <div class="py-3">
      <h1 class="text-xl sm:text-2xl font-extrabold text-center">
        Canciones de la Iglesia <span class="text-primary"><%= account_name %></span>
      </h1>
    </div>
  </div>
</div>

<%# Audio Player - This needs to be outside any fixed/absolute positioned containers %>
<%= render 'shared/audio_player' %>

<%# Tabs Navigation %>
<div data-controller="tabs" data-tabs-default-tab-value="songs" class="w-full pb-12">
  <%# Sticky header containing tabs and navigation %>
  <div class="sticky top-0 left-0 right-0 z-50 bg-base-100">
    <%# Tabs row %>
    <div class="border-b border-base-300">
      <div class="max-w-screen-lg mx-auto px-2">
        <div role="tablist" class="tabs tabs-bordered tabs-lg flex justify-center">
          <a
            role="tab"
            class="tab gap-2"
            data-tabs-target="tab"
            data-tab-name="songs"
            data-action="click->tabs#select"
            href="#songs">
            <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M9 18V5l12-2v13"></path>
              <circle cx="6" cy="18" r="3"></circle>
              <circle cx="18" cy="16" r="3"></circle>
            </svg>
            Canciones
          </a>
          <a
            role="tab"
            class="tab gap-2"
            data-tabs-target="tab"
            data-tab-name="playlists"
            data-action="click->tabs#select"
            href="#playlists">
            <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <path d="M3 12h18M3 6h18M3 18h18"></path>
            </svg>
            Listas
          </a>
        </div>
      </div>
    </div>

    <%# A–Z index and search (only for songs tab) %>
    <div data-tabs-target="panel" data-tab-panel="songs-nav" class="bg-base-100/95 backdrop-blur border-b border-base-300 hidden">
      <div class="max-w-screen-lg mx-auto">
        <%= render 'songs/letters_nav', letters: grouped_songs.keys.sort %>
        <%= render 'shared/search_form', q: @q %>
      </div>
    </div>
  </div>

  <div data-tabs-target="panel" data-tab-panel="songs" class="hidden">
    <%= render 'songs_tab' %>
  </div>

  <div data-tabs-target="panel" data-tab-panel="playlists" class="hidden">
    <%= render 'playlists_tab' %>
  </div>
</div>