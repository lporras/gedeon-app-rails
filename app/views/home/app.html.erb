<%= render 'shared/theme_toggle' %>
<%# search form moved below the fixed A–Z bar spacer %>

<%# Install banner - uses Stimulus controller for PWA installation %>
<%= render 'shared/install_banner' %>

<%# Page header with church/account name (scrolls away) %>
<div class="max-w-screen-lg px-2 mb-2">
  <% account_name = ActsAsTenant.current_tenant&.name || 'Tu Iglesia' %>
  <div>
    <div class="py-3">
      <h1 class="text-xl sm:text-2xl font-extrabold">
        Canciones de la Iglesia <span class="text-primary"><%= account_name %></span>
      </h1>
    </div>
  </div>
</div>

<%# Sticky A–Z index and search (remains visible) %>
<div class="sticky top-0 left-0 right-0 z-40 bg-base-100/95 backdrop-blur border-b border-base-300">
  <!-- Letters row: single-line, scrollable on mobile -->
  <div class="px-2 py-2">
    <div class="flex flex-wrap items-center gap-1 sm:gap-2" data-controller="letter-nav">
      <%- grouped_songs.keys.sort.each do |letter| %>
        <%= link_to "#letter-#{letter}",
            class: "btn btn-ghost btn-xs letter-btn",
            data: {
              action: "click->letter-nav#selectLetter",
              letter: letter,
              target: "letter-nav.letter"
            } do %>
          <%= letter %>
        <% end %>
      <%- end %>
    </div>
  </div>
  <!-- Search form partial -->
  <%= render 'shared/search_form', q: @q %>
</div>
<div class="divider"></div>

<% if @songs.any? %>
  <div class="flex flex-col w-full gap-10 mt-3">
    <% grouped_songs.sort.each do |letter, songs| %>
      <%= render 'songs/letter_group', letter: letter, songs: songs %>
    <% end %>
  </div>
<% else %>
  <%= render 'songs/no_songs' %>
<% end %>